# –ú–æ–¥–µ–ª—å –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ - –ò—Ç–æ–≥–æ–≤—ã–π –æ—Ç—á–µ—Ç

## ‚úÖ –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. –í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (3 —à—Ç.)

–í—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ —Å–æ–∑–¥–∞–Ω—ã —É—Å–ø–µ—à–Ω–æ:

- ‚úÖ `users.admin.devices.device1` - –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 1 –∫–ª–∞—Å—Ç–µ—Ä–∞
- ‚úÖ `users.admin.devices.device2` - –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 2 –∫–ª–∞—Å—Ç–µ—Ä–∞
- ‚úÖ `users.admin.devices.device3` - –í–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ 3 –∫–ª–∞—Å—Ç–µ—Ä–∞

**–î—Ä–∞–π–≤–µ—Ä:** `com.tibbo.linkserver.plugin.device.virtual`

### 2. –ú–æ–¥–µ–ª—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞

‚úÖ `users.admin.models.cluster` - –ú–æ–¥–µ–ª—å –∫–ª–∞—Å—Ç–µ—Ä–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

#### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏:

- ‚úÖ `device1Sine` (Double) - –ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π Sine Wave —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ 1
- ‚úÖ `device2Sine` (Double) - –ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π Sine Wave —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ 2
- ‚úÖ `device3Sine` (Double) - –ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π Sine Wave —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ 3
- ‚úÖ `clusterStatus` (String) - –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞: "–û–ö" –∏–ª–∏ "–æ—à–∏–±–∫–∞"

#### –°–æ–±—ã—Ç–∏—è –º–æ–¥–µ–ª–∏:

- ‚úÖ `clusterAlarm` (ERROR level) - –¢—Ä–µ–≤–æ–≥–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—à–∏–±–∫–∏
  - –§–æ—Ä–º–∞—Ç: `<message><S>`
  - –ò—Å—Ç–æ—Ä–∏—è: 24 —á–∞—Å–∞ (86400000 –º—Å)

### 3. –ü—Ä–∏–≤—è–∑–∫–∏ (Bindings)

–ü—Ä–∏–≤—è–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã —Å **–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º —Ñ–æ—Ä–º–∞—Ç–æ–º —Å—Å—ã–ª–æ–∫ AggreGate**:

- ‚úÖ `.:device1Sine` ‚Üê `{users.admin.devices.device1:sine}`
- ‚úÖ `.:device2Sine` ‚Üê `{users.admin.devices.device2:sine}`
- ‚úÖ `.:device3Sine` ‚Üê `{users.admin.devices.device3:sine}`

**–§–æ—Ä–º–∞—Ç:**
- `target`: `.:–∏–º—è_–ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- `expression`: `{–∫–æ–Ω—Ç–µ–∫—Å—Ç:–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è}` - —Å—Å—ã–ª–∫–∞ –Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥—Ä—É–≥–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- `onevent`: `true` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è

### 4. –õ–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞

‚úÖ **–ü—Ä–∞–≤–∏–ª–æ `checkClusterStatus`** —Å–æ–∑–¥–∞–Ω–æ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ

**–õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã:**
- –ö–ª–∞—Å—Ç–µ—Ä –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ **"–æ—à–∏–±–∫–∞"**, –µ—Å–ª–∏ –≤—Å–µ —Ç—Ä–∏ –∑–Ω–∞—á–µ–Ω–∏—è `sine` –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ > 0
- –í –æ—Å—Ç–∞–ª—å–Ω—ã—Ö —Å–ª—É—á–∞—è—Ö –∫–ª–∞—Å—Ç–µ—Ä –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ **"–û–ö"**
- –ü—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ "–æ—à–∏–±–∫–∞" –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è —Å–æ–±—ã—Ç–∏–µ `clusterAlarm`

**–í—ã—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª–∞:**
```javascript
if (.:device1Sine != null && .:device2Sine != null && .:device3Sine != null) {
  if (.:device1Sine > 0 && .:device2Sine > 0 && .:device3Sine > 0) {
    var oldStatus = .:clusterStatus;
    .:clusterStatus = "–æ—à–∏–±–∫–∞";
    if (oldStatus != "–æ—à–∏–±–∫–∞") {
      .:fireEvent("clusterAlarm@", "–ö–ª–∞—Å—Ç–µ—Ä –ø–µ—Ä–µ—à–µ–ª –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ—à–∏–±–∫–∏: –≤—Å–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏–º–µ—é—Ç sine > 0");
    }
  } else {
    .:clusterStatus = "–û–ö";
  }
}
```

### 5. –í–∏–¥–∂–µ—Ç—ã

- ‚úÖ `users.admin.widgets.clusterStatusWidget` - –í–∏–¥–∂–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
- ‚úÖ `users.admin.widgets.deviceMetricsWidget` - –í–∏–¥–∂–µ—Ç –≥—Ä–∞—Ñ–∏–∫–æ–≤ –º–µ—Ç—Ä–∏–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (sawtooth, triangle, sine)

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –®–∞–±–ª–æ–Ω—ã –≤–∏–¥–∂–µ—Ç–æ–≤ —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Å–º. `CLUSTER_SETUP_INSTRUCTIONS.md`)

### 6. –î–∞—à–±–æ—Ä–¥

- ‚úÖ `users.admin.dashboards.clusterDashboard` - –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –ø–∞–Ω–µ–ª—å —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∞
  - Layout: `dockable`
  - –≠–ª–µ–º–µ–Ω—Ç: –≤–∏–¥–∂–µ—Ç `clusterStatusWidget` –¥–ª—è –º–æ–¥–µ–ª–∏ `users.admin.models.cluster`

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞ (—Å–º. `CLUSTER_SETUP_INSTRUCTIONS.md`)

## üìã –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

```
users.admin
‚îú‚îÄ‚îÄ devices
‚îÇ   ‚îú‚îÄ‚îÄ device1 (Virtual Device)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sine, sawtooth, triangle (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
‚îÇ   ‚îú‚îÄ‚îÄ device2 (Virtual Device)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ sine, sawtooth, triangle (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
‚îÇ   ‚îî‚îÄ‚îÄ device3 (Virtual Device)
‚îÇ       ‚îî‚îÄ‚îÄ sine, sawtooth, triangle (–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ)
‚îú‚îÄ‚îÄ models
‚îÇ   ‚îî‚îÄ‚îÄ cluster (Model Context)
‚îÇ       ‚îú‚îÄ‚îÄ device1Sine ‚Üê {users.admin.devices.device1:sine}
‚îÇ       ‚îú‚îÄ‚îÄ device2Sine ‚Üê {users.admin.devices.device2:sine}
‚îÇ       ‚îú‚îÄ‚îÄ device3Sine ‚Üê {users.admin.devices.device3:sine}
‚îÇ       ‚îú‚îÄ‚îÄ clusterStatus (–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª–æ–º)
‚îÇ       ‚îú‚îÄ‚îÄ clusterAlarm (—Å–æ–±—ã—Ç–∏–µ)
‚îÇ       ‚îî‚îÄ‚îÄ checkClusterStatus (–ø—Ä–∞–≤–∏–ª–æ)
‚îú‚îÄ‚îÄ widgets
‚îÇ   ‚îú‚îÄ‚îÄ clusterStatusWidget
‚îÇ   ‚îî‚îÄ‚îÄ deviceMetricsWidget
‚îî‚îÄ‚îÄ dashboards
    ‚îî‚îÄ‚îÄ clusterDashboard
```

## üîÑ –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

1. **–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö `sine`, `sawtooth`, `triangle`
2. **–ü—Ä–∏–≤—è–∑–∫–∏** –ø–µ—Ä–µ–¥–∞—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è `sine` –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏:
   - `{users.admin.devices.device1:sine}` ‚Üí `.:device1Sine`
   - `{users.admin.devices.device2:sine}` ‚Üí `.:device2Sine`
   - `{users.admin.devices.device3:sine}` ‚Üí `.:device3Sine`
3. **–ü—Ä–∞–≤–∏–ª–æ `checkClusterStatus`** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
   - –ï—Å–ª–∏ –≤—Å–µ —Ç—Ä–∏ `sine` > 0 ‚Üí `clusterStatus = "–æ—à–∏–±–∫–∞"` + –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è `clusterAlarm`
   - –ò–Ω–∞—á–µ ‚Üí `clusterStatus = "–û–ö"`
4. **–í–∏–¥–∂–µ—Ç `clusterStatusWidget`** –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞ –∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤
5. **–ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ** –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è `deviceMetricsWidget` —Å –≥—Ä–∞—Ñ–∏–∫–∞–º–∏ –º–µ—Ç—Ä–∏–∫

## ‚öôÔ∏è –§–æ—Ä–º–∞—Ç —Å—Å—ã–ª–æ–∫ –≤ AggreGate

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ AggreGate:

- **–°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–µ–∫—É—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:** `.:–∏–º—è_—ç–ª–µ–º–µ–Ω—Ç–∞`
- **–°—Å—ã–ª–∫–∞ –Ω–∞ –¥—Ä—É–≥–æ–π –∫–æ–Ω—Ç–µ–∫—Å—Ç:** `{–ø—É—Ç—å.–∫.–∫–æ–Ω—Ç–µ–∫—Å—Ç—É:–∏–º—è_—ç–ª–µ–º–µ–Ω—Ç–∞}`
- **–°–æ–±—ã—Ç–∏—è:** `.:–∏–º—è_—Å–æ–±—ã—Ç–∏—è@` –∏–ª–∏ `{–∫–æ–Ω—Ç–µ–∫—Å—Ç:—Å–æ–±—ã—Ç–∏–µ@}`
- **–§—É–Ω–∫—Ü–∏–∏:** `.:–∏–º—è_—Ñ—É–Ω–∫—Ü–∏–∏()` –∏–ª–∏ `{–∫–æ–Ω—Ç–µ–∫—Å—Ç:—Ñ—É–Ω–∫—Ü–∏—è()}`

–ü–æ–¥—Ä–æ–±–Ω–µ–µ: [–§–æ—Ä–º–∞—Ç —Å—Å—ã–ª–æ–∫ –≤ AggreGate](docs/AGGREGATE_REFERENCES_FORMAT.md)

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–æ–∑–¥–∞–Ω—ã –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
2. ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —à–∞–±–ª–æ–Ω—ã –≤–∏–¥–∂–µ—Ç–æ–≤ —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
3. ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç—Å—è:** –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫ –¥–∞—à–±–æ—Ä–¥–∞ –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
4. ‚ö†Ô∏è **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∞–≤–∏–ª–∞ –∏ –ø—Ä–∏–≤—è–∑–æ–∫

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ](CLUSTER_SETUP_INSTRUCTIONS.md)
- [–°–≤–æ–¥–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è](CLUSTER_SETUP_SUMMARY.md)
- [–§–æ—Ä–º–∞—Ç —Å—Å—ã–ª–æ–∫ –≤ AggreGate](docs/AGGREGATE_REFERENCES_FORMAT.md)
- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ API AggreGate](docs/AGGREGATE_API_GUIDE.md)

